<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A persistent vector."><title>imbl::vector - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-9bb858ba049f1f21.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="imbl" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.0-nightly (f20afcc45 2023-07-04)" data-channel="nightly" data-search-js="search-f6292fe389d70017.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ><script src="../../static.files/storage-59fd9b8ccb335783.js"></script><script defer src="../../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../imbl/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../imbl/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module vector</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">imbl</a>::<wbr><a class="mod" href="#">vector</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/imbl/vector/mod.rs.html#5-2869">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A persistent vector.</p>
<p>This is a sequence of elements in insertion order - if you need a
list of things, any kind of list of things, this is what you’re
looking for.</p>
<p>It’s implemented as an <a href="https://infoscience.epfl.ch/record/213452/files/rrbvector.pdf">RRB vector</a> with <a href="http://deepsea.inria.fr/pasl/chunkedseq.pdf">smart
head/tail chunking</a>. In performance terms, this means
that practically every operation is O(log n), except push/pop on
both sides, which will be O(1) amortised, and O(log n) in the
worst case. In practice, the push/pop operations will be
blindingly fast, nearly on par with the native
<a href="https://doc.rust-lang.org/std/collections/struct.VecDeque.html"><code>VecDeque</code></a>, and other operations will have decent, if
not high, performance, but they all have more or less the same
O(log n) complexity, so you don’t need to keep their performance
characteristics in mind - everything, even splitting and merging,
is safe to use and never too slow.</p>
<h3 id="performance-notes"><a href="#performance-notes">Performance Notes</a></h3>
<p>Because of the head/tail chunking technique, until you push a
number of items above double the tree’s branching factor (that’s
<code>self.len()</code> = 2 × <em>k</em> (where <em>k</em> = 64) = 128) on either side, the
data structure is still just a handful of arrays, not yet an RRB
tree, so you’ll see performance and memory characteristics fairly
close to <a href="https://doc.rust-lang.org/std/vec/struct.Vec.html"><code>Vec</code></a> or <a href="https://doc.rust-lang.org/std/collections/struct.VecDeque.html"><code>VecDeque</code></a>.</p>
<p>This means that the structure always preallocates four chunks of
size <em>k</em> (<em>k</em> being the tree’s branching factor), equivalent to a
<a href="https://doc.rust-lang.org/std/vec/struct.Vec.html"><code>Vec</code></a> with an initial capacity of 256. Beyond that, it will
allocate tree nodes of capacity <em>k</em> as needed.</p>
<p>In addition, vectors start out as single chunks, and only expand into the
full data structure once you go past the chunk size. This makes them
perform identically to <a href="https://doc.rust-lang.org/std/vec/struct.Vec.html"><code>Vec</code></a> at small sizes.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Chunks.html" title="struct imbl::vector::Chunks">Chunks</a></div><div class="desc docblock-short">An iterator over the leaf nodes of a vector.</div></li><li><div class="item-name"><a class="struct" href="struct.ChunksMut.html" title="struct imbl::vector::ChunksMut">ChunksMut</a></div><div class="desc docblock-short">A mutable iterator over the leaf nodes of a vector.</div></li><li><div class="item-name"><a class="struct" href="struct.ConsumingIter.html" title="struct imbl::vector::ConsumingIter">ConsumingIter</a></div><div class="desc docblock-short">A consuming iterator over vectors with values of type <code>A</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.Iter.html" title="struct imbl::vector::Iter">Iter</a></div><div class="desc docblock-short">An iterator over vectors with values of type <code>A</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.IterMut.html" title="struct imbl::vector::IterMut">IterMut</a></div><div class="desc docblock-short">A mutable iterator over vectors with values of type <code>A</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.RRBPool.html" title="struct imbl::vector::RRBPool">RRBPool</a></div><div class="desc docblock-short">A memory pool for <code>Vector</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.Vector.html" title="struct imbl::vector::Vector">Vector</a></div><div class="desc docblock-short">A persistent vector.</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.Focus.html" title="enum imbl::vector::Focus">Focus</a></div><div class="desc docblock-short">Focused indexing over a <a href="enum.Vector.html"><code>Vector</code></a>.</div></li><li><div class="item-name"><a class="enum" href="enum.FocusMut.html" title="enum imbl::vector::FocusMut">FocusMut</a></div><div class="desc docblock-short">A mutable version of <a href="enum.Focus.html"><code>Focus</code></a>.</div></li></ul></section></div></main></body></html>